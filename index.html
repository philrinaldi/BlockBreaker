<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BlockBreaker.com - Minecraft Block Breaker Game</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Courier New', monospace;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><rect x="8" y="4" width="4" height="4" fill="%23FFD700"/><rect x="12" y="8" width="4" height="4" fill="%23FFD700"/><rect x="16" y="12" width="4" height="4" fill="%23FFD700"/><rect x="20" y="16" width="4" height="4" fill="%23A0522D"/><rect x="24" y="20" width="4" height="4" fill="%23A0522D"/><rect x="28" y="24" width="4" height="4" fill="%23A0522D"/></svg>') 16 16, auto;
            /* Prevent text selection and zooming on mobile */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            /* Prevent pull-to-refresh on mobile */
            overscroll-behavior: none;
            /* Disable iOS bounce effect */
            -webkit-overflow-scrolling: touch;
        }
        
        .game-active-cursor {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><rect x="8" y="4" width="4" height="4" fill="%23FFD700"/><rect x="12" y="8" width="4" height="4" fill="%23FFD700"/><rect x="16" y="12" width="4" height="4" fill="%23FFD700"/><rect x="20" y="16" width="4" height="4" fill="%23A0522D"/><rect x="24" y="20" width="4" height="4" fill="%23A0522D"/><rect x="28" y="24" width="4" height="4" fill="%23A0522D"/></svg>') 16 16, pointer;
        }
        
        .game-ui-compact {
            position: fixed;
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            transition: all 0.5s ease-in-out;
            width: auto;
            max-width: 600px;
            padding: 0;
            background: transparent;
            border-radius: 0;
            backdrop-filter: none;
            border: none;
            box-shadow: none;
            min-height: auto;
        }
        
        /* Hide entire hero section content during gameplay */
        .game-ui-compact .max-w-4xl {
            display: none;
        }
        
        /* Create a separate compact gameplay UI */
        .compact-gameplay-ui {
            display: none;
            text-align: center;
        }
        
        .game-ui-compact .compact-gameplay-ui {
            display: block;
        }
        
        /* Keep navigation visible during gameplay */
        .nav-gameplay-mode {
            position: fixed !important;
            top: 0;
            left: 0;
            right: 0;
            z-index: 999;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
        }
        
        .game-ui-compact #gameControls button {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .game-ui-normal {
            position: relative;
            transform: none;
            transition: all 0.5s ease-in-out;
        }
        
        .bubble {
            position: absolute;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><rect x="8" y="4" width="4" height="4" fill="%23FFD700"/><rect x="12" y="8" width="4" height="4" fill="%23FFD700"/><rect x="16" y="12" width="4" height="4" fill="%23FFD700"/><rect x="20" y="16" width="4" height="4" fill="%23A0522D"/><rect x="24" y="20" width="4" height="4" fill="%23A0522D"/><rect x="28" y="24" width="4" height="4" fill="%23A0522D"/></svg>') 16 16, pointer;
            transition: all 0.2s ease;
            z-index: 1000;
            image-rendering: pixelated;
            border: 2px solid #333;
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.3),
                inset -2px -2px 0 rgba(0,0,0,0.3),
                2px 2px 8px rgba(0,0,0,0.5);
            animation: float 4s ease-in-out infinite;
            /* Touch-friendly styling */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            /* Improve touch target size on small screens */
            min-width: 44px;
            min-height: 44px;
        }
        
        .bubble:hover {
            transform: scale(1.05);
            filter: brightness(1.2);
        }
        
        .bubble:active {
            transform: scale(0.95);
        }
        
        /* Touch feedback for mobile devices */
        .bubble.touch-feedback {
            transform: scale(0.9);
            filter: brightness(1.3);
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.5),
                inset -2px -2px 0 rgba(0,0,0,0.5),
                0 0 15px rgba(255, 215, 0, 0.8);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
        
        @keyframes pop {
            0% { transform: scale(1); opacity: 1; }
            25% { transform: scale(1.2) rotate(5deg); }
            50% { transform: scale(0.8) rotate(-5deg); }
            75% { transform: scale(1.1); }
            100% { transform: scale(0); opacity: 0; }
        }
        
        @keyframes bigPop {
            0% { transform: scale(1); opacity: 1; }
            15% { transform: scale(1.4) rotate(10deg); }
            30% { transform: scale(0.6) rotate(-10deg); }
            45% { transform: scale(1.3) rotate(5deg); }
            60% { transform: scale(0.8) rotate(-5deg); }
            75% { transform: scale(1.2); }
            100% { transform: scale(0); opacity: 0; }
        }
        
        @keyframes sparkle {
            0% { opacity: 1; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1.5) rotate(180deg); }
            100% { opacity: 0; transform: scale(2) rotate(360deg); }
        }
        
        .pop-animation {
            animation: pop 0.4s ease-out forwards;
        }
        
        .big-pop-animation {
            animation: bigPop 0.6s ease-out forwards;
        }
        
        .sparkle-effect {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #FFD700;
            border-radius: 50%;
            pointer-events: none;
            z-index: 2000;
            animation: sparkle 0.8s ease-out forwards;
        }
        
        .confetti {
            position: absolute;
            width: 8px;
            height: 8px;
            pointer-events: none;
            z-index: 3000;
            animation: firework-explode 4s ease-out forwards;
            box-shadow: 0 0 6px currentColor;
        }
        
        .firework-trail {
            position: absolute;
            width: 4px;
            height: 20px;
            pointer-events: none;
            z-index: 2999;
            animation: firework-trail 4s ease-out forwards;
            border-radius: 2px;
        }
        
        @keyframes firework-explode {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(0.2);
                opacity: 0;
            }
            10% {
                transform: translate(0, 0) rotate(0deg) scale(1.5);
                opacity: 1;
            }
            50% {
                transform: translate(calc(var(--x-distance) * 0.8), calc(var(--y-distance) * 0.8)) rotate(360deg) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--x-distance), var(--y-distance)) rotate(720deg) scale(0.1);
                opacity: 0;
            }
        }
        
        @keyframes firework-trail {
            0% {
                transform: translate(0, 0) scaleY(0);
                opacity: 0.8;
            }
            20% {
                transform: translate(calc(var(--x-distance) * 0.2), calc(var(--y-distance) * 0.2)) scaleY(1);
                opacity: 0.6;
            }
            100% {
                transform: translate(calc(var(--x-distance) * 0.8), calc(var(--y-distance) * 0.8)) scaleY(0.2);
                opacity: 0;
            }
        }
        
        .minecraft-bg {
            background: linear-gradient(45deg, #4a7c59 0%, #8fbc8f 25%, #6b8e23 50%, #556b2f 75%, #2e8b57 100%);
            background-size: 40px 40px;
            position: relative;
            transition: all 2s ease-in-out;
        }
        
        .minecraft-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 20px,
                    rgba(0,0,0,0.1) 20px,
                    rgba(0,0,0,0.1) 21px
                ),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 20px,
                    rgba(0,0,0,0.1) 20px,
                    rgba(0,0,0,0.1) 21px
                );
            transition: all 2s ease-in-out;
        }

        /* Animation for compact UI entrance */
        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(-100%);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
        
        .game-ui-compact.animate-entrance {
            animation: slideInFromTop 0.6s ease-out;
        }
        
        /* Mobile optimizations for compact UI */
        @media (max-width: 768px) {
            .game-ui-compact {
                width: 95%;
                padding: 12px 15px;
            }
            
            .game-ui-compact #counter {
                font-size: 20px;
            }
            
            .game-ui-compact #gameControls button {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            /* Improve bubble visibility on mobile */
            .bubble {
                min-width: 50px;
                min-height: 50px;
                border: 3px solid #333;
            }
            
            /* Larger touch targets for gameplay controls */
            .gameplay-controls button {
                padding: 12px 16px !important;
                font-size: 16px !important;
                min-height: 48px;
                min-width: 120px;
            }
            
            /* Better spacing for mobile counter */
            .gameplay-counter {
                top: 70px;
                padding: 12px 16px;
            }
            
            /* Reduce navigation height on mobile during gameplay */
            .nav-gameplay-mode {
                padding: 8px 16px;
            }
            
            /* Make main buttons more touch-friendly */
            .minecraft-button {
                min-height: 48px;
                min-width: 120px;
                padding: 12px 16px;
                font-size: 16px;
            }
            
            /* Responsive text sizes */
            h1 {
                font-size: 2.5rem !important;
            }
            
            .text-xl {
                font-size: 1.125rem;
            }
            
            /* Better mobile layout for features grid */
            #features {
                grid-template-columns: 1fr;
                gap: 4;
                max-width: 100%;
            }
            
            /* Mobile footer */
            footer {
                position: relative !important;
                margin-top: 2rem;
            }
            
            footer .flex {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            /* Mobile navigation styling */
            nav {
                padding: 1rem;
            }
            
            #mobileMenu {
                background: rgba(0, 0, 0, 0.8);
                border-radius: 8px;
                padding: 1rem;
                border: 2px solid rgba(255, 215, 0, 0.3);
            }
        }
        
        /* Landscape orientation optimizations for mobile */
        @media screen and (orientation: landscape) and (max-height: 600px) {
            h1 {
                font-size: 1.5rem !important;
            }
            
            .text-xl {
                font-size: 1rem;
            }
            
            .gameplay-controls {
                top: 2px;
            }
            
            .gameplay-counter {
                top: 45px;
            }
            
            .bubble {
                min-width: 40px;
                min-height: 40px;
            }
        }
        
        /* Additional mobile device styling */
        .mobile-device .bubble {
            /* Larger tap targets for mobile */
            min-width: 48px;
            min-height: 48px;
        }
        
        .mobile-device .minecraft-button {
            /* Ensure all buttons meet touch target guidelines */
            min-height: 44px;
            min-width: 44px;
        }
        
        /* Extra small screens */
        @media (max-width: 480px) {
            .bubble {
                min-width: 45px;
                min-height: 45px;
            }
            
            h1 {
                font-size: 2rem !important;
            }
            
            .gameplay-controls {
                top: 5px;
            }
            
            .gameplay-counter {
                top: 60px;
            }
            
            .nav-gameplay-mode {
                padding: 6px 12px;
            }
            
            .minecraft-button {
                min-height: 44px;
                min-width: 100px;
                padding: 10px 14px;
                font-size: 14px;
            }
        }
        
        /* Background themes for different levels */
        .bg-overworld {
            background: linear-gradient(45deg, #4a7c59 0%, #8fbc8f 25%, #6b8e23 50%, #556b2f 75%, #2e8b57 100%);
        }
        
        /* Plains Biomes */
        .bg-plains {
            background: linear-gradient(45deg, #228B22 0%, #90EE90 25%, #32CD32 50%, #9ACD32 75%, #ADFF2F 100%);
        }
        
        .bg-ice-plains {
            background: linear-gradient(45deg, #E0FFFF 0%, #B0E0E6 25%, #87CEEB 50%, #ADD8E6 75%, #F0F8FF 100%);
        }
        
        .bg-ice-spikes {
            background: linear-gradient(45deg, #E6E6FA 0%, #F0F8FF 25%, #FFFAFA 50%, #F8F8FF 75%, #E0FFFF 100%);
        }
        
        .bg-sunflower-plains {
            background: linear-gradient(45deg, #FFD700 0%, #FFFF00 25%, #9ACD32 50%, #32CD32 75%, #228B22 100%);
        }
        
        .bg-snowy-plains {
            background: linear-gradient(45deg, #FFFAFA 0%, #F0F8FF 25%, #E0FFFF 50%, #B0E0E6 75%, #87CEEB 100%);
        }
        
        .bg-mushroom-field {
            background: linear-gradient(45deg, #8B4513 0%, #A0522D 25%, #CD853F 50%, #D2691E 75%, #DEB887 100%);
        }
        
        .bg-savanna {
            background: linear-gradient(45deg, #F4A460 0%, #DAA520 25%, #B8860B 50%, #CD853F 75%, #DEB887 100%);
        }
        
        /* Forest Biomes */
        .bg-forest {
            background: linear-gradient(45deg, #228B22 0%, #32CD32 25%, #006400 50%, #008000 75%, #2E8B57 100%);
        }
        
        .bg-birch-forest {
            background: linear-gradient(45deg, #F5F5DC 0%, #FFFFE0 25%, #32CD32 50%, #90EE90 75%, #98FB98 100%);
        }
        
        .bg-dark-forest {
            background: linear-gradient(45deg, #2F4F4F 0%, #1C1C1C 25%, #006400 50%, #013220 75%, #000000 100%);
        }
        
        .bg-flower-forest {
            background: linear-gradient(45deg, #FF69B4 0%, #FFB6C1 25%, #90EE90 50%, #FFA500 75%, #FF1493 100%);
        }
        
        .bg-old-birch {
            background: linear-gradient(45deg, #F5F5DC 0%, #FFFACD 25%, #32CD32 50%, #228B22 75%, #006400 100%);
        }
        
        .bg-taiga {
            background: linear-gradient(45deg, #2F4F4F 0%, #556B2F 25%, #6B8E23 50%, #228B22 75%, #008000 100%);
        }
        
        .bg-old-spruce {
            background: linear-gradient(45deg, #1C4A1C 0%, #2F4F4F 25%, #006400 50%, #013220 75%, #002200 100%);
        }
        
        .bg-old-pine {
            background: linear-gradient(45deg, #696969 0%, #2F4F4F 25%, #556B2F 50%, #6B8E23 75%, #8FBC8F 100%);
        }
        
        .bg-snowy-taiga {
            background: linear-gradient(45deg, #FFFAFA 0%, #F0F8FF 25%, #2F4F4F 50%, #556B2F 75%, #6B8E23 100%);
        }
        
        .bg-jungle {
            background: linear-gradient(45deg, #228B22 0%, #32CD32 25%, #006400 50%, #008000 75%, #ADFF2F 100%);
        }
        
        .bg-bamboo-jungle {
            background: linear-gradient(45deg, #9ACD32 0%, #ADFF2F 25%, #32CD32 50%, #228B22 75%, #006400 100%);
        }
        
        .bg-sparse-jungle {
            background: linear-gradient(45deg, #90EE90 0%, #98FB98 25%, #32CD32 50%, #228B22 75%, #006400 100%);
        }
        
        .bg-grove {
            background: linear-gradient(45deg, #FFFAFA 0%, #F0F8FF 25%, #2F4F4F 50%, #556B2F 75%, #FFFAFA 100%);
        }
        
        .bg-cherry-grove {
            background: linear-gradient(45deg, #FFB6C1 0%, #FFC0CB 25%, #FF69B4 50%, #FF1493 75%, #90EE90 100%);
        }
        
        .bg-pale-garden {
            background: linear-gradient(45deg, #2F2F2F 0%, #1C1C1C 25%, #696969 50%, #A9A9A9 75%, #D3D3D3 100%);
        }
        
        .bg-cave {
            background: linear-gradient(45deg, #2c2c2c 0%, #404040 25%, #1a1a1a 50%, #333333 75%, #262626 100%);
        }
        
        /* Cave Biomes */
        .bg-deep-dark {
            background: linear-gradient(45deg, #000000 0%, #1C1C1C 25%, #0F0F0F 50%, #2F2F2F 75%, #0A0A0A 100%);
        }
        
        .bg-dripstone-caves {
            background: linear-gradient(45deg, #696969 0%, #2F2F2F 25%, #8B7D6B 50%, #A0522D 75%, #CD853F 100%);
        }
        
        .bg-lush-caves {
            background: linear-gradient(45deg, #228B22 0%, #32CD32 25%, #90EE90 50%, #98FB98 75%, #ADFF2F 100%);
        }
        
        /* Mountain Biomes */
        .bg-jagged-peaks {
            background: linear-gradient(45deg, #FFFAFA 0%, #F0F8FF 25%, #696969 50%, #2F4F4F 75%, #E0FFFF 100%);
        }
        
        .bg-frozen-peaks {
            background: linear-gradient(45deg, #E0FFFF 0%, #B0E0E6 25%, #87CEEB 50%, #ADD8E6 75%, #F0F8FF 100%);
        }
        
        .bg-stony-peaks {
            background: linear-gradient(45deg, #696969 0%, #808080 25%, #A9A9A9 50%, #C0C0C0 75%, #D3D3D3 100%);
        }
        
        .bg-snowy-slopes {
            background: linear-gradient(45deg, #FFFAFA 0%, #F0F8FF 25%, #E0FFFF 50%, #696969 75%, #2F4F4F 100%);
        }
        
        .bg-windswept-hills {
            background: linear-gradient(45deg, #90EE90 0%, #98FB98 25%, #696969 50%, #2F4F4F 75%, #808080 100%);
        }
        
        .bg-windswept-forest {
            background: linear-gradient(45deg, #90EE90 0%, #32CD32 25%, #228B22 50%, #696969 75%, #2F4F4F 100%);
        }
        
        .bg-windswept-gravelly {
            background: linear-gradient(45deg, #696969 0%, #808080 25%, #A9A9A9 50%, #C0C0C0 75%, #D3D3D3 100%);
        }
        
        .bg-meadow {
            background: linear-gradient(45deg, #FFD700 0%, #FFFF00 25%, #90EE90 50%, #FF69B4 75%, #32CD32 100%);
        }
        
        .bg-stony-shores {
            background: linear-gradient(45deg, #696969 0%, #2F4F4F 25%, #4682B4 50%, #87CEEB 75%, #B0E0E6 100%);
        }
        
        .bg-savanna-plateau {
            background: linear-gradient(45deg, #F4A460 0%, #DAA520 25%, #696969 50%, #2F4F4F 75%, #DEB887 100%);
        }
        
        .bg-windswept-savanna {
            background: linear-gradient(45deg, #F4A460 0%, #DAA520 25%, #696969 50%, #808080 75%, #2F4F4F 100%);
        }
        
        /* Swamp Biomes */
        .bg-swamp {
            background: linear-gradient(45deg, #2F4F4F 0%, #556B2F 25%, #6B8E23 50%, #8FBC8F 75%, #228B22 100%);
        }
        
        .bg-mangrove-swamp {
            background: linear-gradient(45deg, #8B4513 0%, #A0522D 25%, #228B22 50%, #32CD32 75%, #6B8E23 100%);
        }
        
        /* Sandy/Desert Biomes */
        .bg-badlands {
            background: linear-gradient(45deg, #CD853F 0%, #D2691E 25%, #B22222 50%, #8B0000 75%, #A0522D 100%);
        }
        
        .bg-wooded-badlands {
            background: linear-gradient(45deg, #CD853F 0%, #8B4513 25%, #A0522D 50%, #D2691E 75%, #228B22 100%);
        }
        
        .bg-eroded-badlands {
            background: linear-gradient(45deg, #FF6347 0%, #DC143C 25%, #B22222 50%, #8B0000 75%, #A0522D 100%);
        }
        
        .bg-beach {
            background: linear-gradient(45deg, #F4A460 0%, #DEB887 25%, #4682B4 50%, #87CEEB 75%, #B0E0E6 100%);
        }
        
        .bg-snowy-beach {
            background: linear-gradient(45deg, #FFFAFA 0%, #F0F8FF 25%, #4682B4 50%, #87CEEB 75%, #B0E0E6 100%);
        }
        
        .bg-desert {
            background: linear-gradient(45deg, #F4A460 0%, #DEB887 25%, #D2B48C 50%, #BC8F8F 75%, #F5DEB3 100%);
        }
        
        /* Water Biomes */
        .bg-river {
            background: linear-gradient(45deg, #4682B4 0%, #87CEEB 25%, #B0E0E6 50%, #AFEEEE 75%, #E0FFFF 100%);
        }
        
        .bg-frozen-river {
            background: linear-gradient(45deg, #E0FFFF 0%, #B0E0E6 25%, #87CEEB 50%, #4682B4 75%, #F0F8FF 100%);
        }
        
        .bg-ocean {
            background: linear-gradient(45deg, #006994 0%, #4682b4 25%, #1e90ff 50%, #87ceeb 75%, #b0e0e6 100%);
        }
        
        .bg-cold-ocean {
            background: linear-gradient(45deg, #191970 0%, #4169E1 25%, #4682B4 50%, #6495ED 75%, #87CEEB 100%);
        }
        
        .bg-deep-ocean {
            background: linear-gradient(45deg, #000080 0%, #191970 25%, #4169E1 50%, #1E90FF 75%, #4682B4 100%);
        }
        
        .bg-frozen-ocean {
            background: linear-gradient(45deg, #E0FFFF 0%, #B0E0E6 25%, #87CEEB 50%, #4682B4 75%, #F0F8FF 100%);
        }
        
        .bg-lukewarm-ocean {
            background: linear-gradient(45deg, #20B2AA 0%, #48D1CC 25%, #40E0D0 50%, #00CED1 75%, #5F9EA0 100%);
        }
        
        .bg-warm-ocean {
            background: linear-gradient(45deg, #FF7F50 0%, #FFA500 25%, #FFD700 50%, #20B2AA 75%, #00CED1 100%);
        }
        
        /* Nether Biomes */
        .bg-nether-wastes {
            background: linear-gradient(45deg, #8b0000 0%, #dc143c 25%, #b22222 50%, #a0522d 75%, #cd853f 100%);
        }
        
        .bg-soul-sand-valley {
            background: linear-gradient(45deg, #8B7D6B 0%, #696969 25%, #2F4F4F 50%, #1C1C1C 75%, #000000 100%);
        }
        
        .bg-basalt-deltas {
            background: linear-gradient(45deg, #2F2F2F 0%, #696969 25%, #1C1C1C 50%, #000000 75%, #808080 100%);
        }
        
        .bg-crimson-forest {
            background: linear-gradient(45deg, #8B0000 0%, #DC143C 25%, #B22222 50%, #FF6347 75%, #CD5C5C 100%);
        }
        
        .bg-warped-forest {
            background: linear-gradient(45deg, #008B8B 0%, #00CED1 25%, #40E0D0 50%, #48D1CC 75%, #20B2AA 100%);
        }
        
        .bg-nether {
            background: linear-gradient(45deg, #8b0000 0%, #dc143c 25%, #b22222 50%, #a0522d 75%, #cd853f 100%);
        }
        
        .bg-mesa {
            background: linear-gradient(45deg, #deb887 0%, #d2691e 25%, #cd853f 50%, #bc8f8f 75%, #f4a460 100%);
        }
        
        /* End Biomes */
        .bg-end {
            background: linear-gradient(45deg, #2e2b5f 0%, #8b5cf6 25%, #4c1d95 50%, #1e1b4b 75%, #312e81 100%);
        }
        
        .bg-end-barrens {
            background: linear-gradient(45deg, #1e1b4b 0%, #2e2b5f 25%, #4c1d95 50%, #312e81 75%, #6b46c1 100%);
        }
        
        .bg-end-highlands {
            background: linear-gradient(45deg, #8b5cf6 0%, #a78bfa 25%, #c4b5fd 50%, #ddd6fe 75%, #ede9fe 100%);
        }
        
        .bg-end-midlands {
            background: linear-gradient(45deg, #4c1d95 0%, #6b46c1 25%, #8b5cf6 50%, #a78bfa 75%, #c4b5fd 100%);
        }
        
        .bg-small-end-islands {
            background: linear-gradient(45deg, #312e81 0%, #4c1d95 25%, #6b46c1 50%, #8b5cf6 75%, #a78bfa 100%);
        }
        
        .bg-real-end {
            background: linear-gradient(45deg, #000000 0%, #1a1a1a 25%, #000000 50%, #2d2d2d 75%, #000000 100%);
            box-shadow: inset 0 0 100px rgba(138, 43, 226, 0.3);
        }
        
        .bg-blood-level {
            background: linear-gradient(45deg, #8B0000 0%, #B22222 25%, #DC143C 50%, #8B0000 75%, #FF0000 100%);
            box-shadow: inset 0 0 150px rgba(255, 0, 0, 0.5);
        }
        
        .counter-glow {
            text-shadow: 0 0 10px #ffff00, 0 0 20px #ffff00;
            font-family: 'Courier New', monospace;
            font-weight: bold;
        }
        
        .minecraft-button {
            font-family: 'Courier New', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: 3px solid #333;
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.3),
                inset -2px -2px 0 rgba(0,0,0,0.3),
                3px 3px 0 #222;
            transition: all 0.1s ease;
        }
        
        .minecraft-button:hover {
            transform: translate(-1px, -1px);
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.4),
                inset -2px -2px 0 rgba(0,0,0,0.4),
                4px 4px 0 #222;
        }
        
        .minecraft-button:active {
            transform: translate(1px, 1px);
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.2),
                inset -2px -2px 0 rgba(0,0,0,0.2),
                2px 2px 0 #222;
        }
        
        .minecraft-panel {
            border: 3px solid #333;
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.2),
                inset -2px -2px 0 rgba(0,0,0,0.2);
            background: rgba(139, 69, 19, 0.8);
        }
        
        /* Separate UI elements for gameplay */
        .gameplay-controls {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            display: none;
        }
        
        .gameplay-counter {
            position: fixed;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 8px 12px;
            border-radius: 6px;
            border: 2px solid rgba(255, 215, 0, 0.4);
            backdrop-filter: blur(10px);
            display: none;
        }
        
        /* Show gameplay UI elements when game is active */
        body.game-active .gameplay-controls {
            display: flex;
        }
        
        body.game-active .gameplay-counter {
            display: block;
        }
    </style>
</head>
<body class="minecraft-bg min-h-screen overflow-hidden relative">
    <!-- Header -->
    <nav class="relative z-50 px-6 py-4">
        <div class="flex justify-between items-center">
            <div class="text-yellow-300 font-bold text-xl md:text-2xl" style="font-family: 'Courier New', monospace; text-shadow: 2px 2px 0 #333;">
                ⛏️ BLOCKBREAKER.COM
            </div>
            <div class="hidden md:flex space-x-6">
                <a href="#game" class="text-yellow-300 hover:text-yellow-400 transition-colors font-bold" style="text-shadow: 1px 1px 0 #333;">MINE</a>
                <a href="#features" class="text-yellow-300 hover:text-yellow-400 transition-colors font-bold" style="text-shadow: 1px 1px 0 #333;">FEATURES</a>
                <a href="#about" class="text-yellow-300 hover:text-yellow-400 transition-colors font-bold" style="text-shadow: 1px 1px 0 #333;">ABOUT</a>
            </div>
            <!-- Mobile menu button -->
            <div class="md:hidden">
                <button id="mobileMenuBtn" class="text-yellow-300 text-xl">
                    ☰
                </button>
            </div>
        </div>
        <!-- Mobile menu -->
        <div id="mobileMenu" class="hidden md:hidden mt-4 space-y-2">
            <a href="#game" class="block text-yellow-300 hover:text-yellow-400 transition-colors font-bold py-2" style="text-shadow: 1px 1px 0 #333;">MINE</a>
            <a href="#features" class="block text-yellow-300 hover:text-yellow-400 transition-colors font-bold py-2" style="text-shadow: 1px 1px 0 #333;">FEATURES</a>
            <a href="#about" class="block text-yellow-300 hover:text-yellow-400 transition-colors font-bold py-2" style="text-shadow: 1px 1px 0 #333;">ABOUT</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <div id="heroSection" class="relative z-10 flex flex-col items-center justify-center min-h-screen px-6 text-center game-ui-normal">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-5xl md:text-7xl font-bold text-yellow-300 mb-6 leading-tight" style="font-family: 'Courier New', monospace; text-shadow: 3px 3px 0 #333;">
                MINE YOUR WAY TO 
                <span class="text-green-400" style="text-shadow: 3px 3px 0 #333;">
                    DIAMONDS
                </span>
            </h1>
            
            <p class="text-xl md:text-2xl text-green-200 mb-8 max-w-2xl mx-auto" style="font-family: 'Courier New', monospace; text-shadow: 1px 1px 0 #333;">
                The most satisfying block breaking experience! Mine blocks, collect resources, and become the ultimate miner!
            </p>
            
            <!-- Mobile touch instruction -->
            <div id="touchHint" class="mb-6 md:hidden">
                <p class="text-sm text-yellow-200 bg-black bg-opacity-50 px-4 py-2 rounded inline-block" style="font-family: 'Courier New', monospace;">
                    📱 Tap blocks to mine them on touch devices!
                </p>
            </div>

            <!-- Counter Display -->
            <div id="gameUI" class="mb-8">
                <div class="inline-flex items-center minecraft-panel rounded px-8 py-4">
                    <span class="text-yellow-300 text-lg font-bold mr-3" style="text-shadow: 1px 1px 0 #333;">BLOCKS MINED:</span>
                    <span id="counter" class="text-3xl font-bold text-yellow-400 counter-glow">0</span>
                </div>
                <div class="inline-flex items-center minecraft-panel rounded px-6 py-2 mt-3">
                    <span class="text-green-300 text-sm font-bold mr-2" style="text-shadow: 1px 1px 0 #333;">BIOME:</span>
                    <span id="biomeDisplay" class="text-lg font-bold text-green-400" style="text-shadow: 1px 1px 0 #333;">Overworld</span>
                </div>
                <div class="inline-flex items-center minecraft-panel rounded px-4 py-1 mt-2">
                    <span class="text-blue-300 text-xs font-bold mr-2" style="text-shadow: 1px 1px 0 #333;">NEXT:</span>
                    <span id="nextBiomeDisplay" class="text-sm font-bold text-blue-400" style="text-shadow: 1px 1px 0 #333;">Plains (50 blocks)</span>
                </div>
            </div>

            <!-- Game Controls -->
            <div id="gameControls" class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-12">
                <button id="startGame" class="minecraft-button bg-green-600 hover:bg-green-500 text-white font-bold py-4 px-8 rounded">
                    ⛏️ START MINING!
                </button>
                <button id="stopGame" class="minecraft-button bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-4 px-8 rounded hidden">
                    ⏹️ STOP MINING
                </button>
                <button id="resetGame" class="minecraft-button bg-red-600 hover:bg-red-500 text-white font-bold py-4 px-8 rounded">
                    🔄 RESET MINE
                </button>
                <button id="musicToggle" class="minecraft-button bg-purple-600 hover:bg-purple-500 text-white font-bold py-4 px-8 rounded">
                    🎵 MUSIC: ON
                </button>
            </div>

            <!-- Features Grid -->
            <div id="features" class="grid md:grid-cols-3 gap-6 max-w-4xl mx-auto">
                <div class="minecraft-panel rounded-xl p-6">
                    <div class="text-4xl mb-4">⛏️</div>
                    <h3 class="text-xl font-bold text-yellow-300 mb-2" style="text-shadow: 1px 1px 0 #333;">PRECISION MINING</h3>
                    <p class="text-green-200" style="text-shadow: 1px 1px 0 #333;">Click blocks with perfect precision. Every block counts!</p>
                </div>
                
                <div class="minecraft-panel rounded-xl p-6">
                    <div class="text-4xl mb-4">💎</div>
                    <h3 class="text-xl font-bold text-yellow-300 mb-2" style="text-shadow: 1px 1px 0 #333;">RARE BLOCKS</h3>
                    <p class="text-green-200" style="text-shadow: 1px 1px 0 #333;">Discover diamond, emerald, and gold blocks as you mine!</p>
                </div>
                
                <div class="minecraft-panel rounded-xl p-6">
                    <div class="text-4xl mb-4">🏗️</div>
                    <h3 class="text-xl font-bold text-yellow-300 mb-2" style="text-shadow: 1px 1px 0 #333;">ENDLESS MINING</h3>
                    <p class="text-green-200" style="text-shadow: 1px 1px 0 #333;">Perfect for relaxation and satisfying block-breaking action.</p>
                </div>
            </div>
        </div>
        
        <!-- Compact Gameplay UI (shown only during gameplay) -->
        <div class="compact-gameplay-ui">
            <!-- This div will be empty since we're using separate positioned elements -->
        </div>
    </div>

    <!-- Separate Gameplay Controls (top center) -->
    <div class="gameplay-controls">
        <div class="flex justify-center gap-2">
            <button id="compactStopGame" class="minecraft-button bg-yellow-600 hover:bg-yellow-500 text-white font-bold py-2 px-4 rounded text-sm">
                ⏹️ STOP MINING
            </button>
            <button id="compactResetGame" class="minecraft-button bg-red-600 hover:bg-red-500 text-white font-bold py-2 px-4 rounded text-sm">
                🔄 RESET MINE
            </button>
            <button id="compactMusicToggle" class="minecraft-button bg-purple-600 hover:bg-purple-500 text-white font-bold py-2 px-4 rounded text-sm">
                🎵
            </button>
        </div>
    </div>

    <!-- Separate Counter Display (top right) -->
    <div class="gameplay-counter">
        <div class="text-center">
            <div class="text-yellow-300 text-xs font-bold mb-1" style="text-shadow: 1px 1px 0 #333;">BLOCKS MINED</div>
            <div id="compactCounter" class="text-xl font-bold text-yellow-400 counter-glow">0</div>
            <div class="text-green-300 text-xs font-bold mt-1" style="text-shadow: 1px 1px 0 #333;">BIOME</div>
            <div id="compactBiomeDisplay" class="text-sm font-bold text-green-400" style="text-shadow: 1px 1px 0 #333;">Overworld</div>
        </div>
    </div>

    <!-- Background Music -->
    <audio id="backgroundMusic" loop preload="auto" style="display: none;">
        <source src="https://archive.org/download/Minecraft_OST/Minecraft.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <!-- Block Break Sound Effect -->
    <audio id="blockBreakSound" preload="auto" style="display: none;">
        <source src="c:\Users\Aidan\Downloads\Untitled video - Made with Clipchamp (2).mp4" type="audio/mp4">
        Your browser does not support the audio element.
    </audio>

    <!-- Game Area (Hidden behind content) -->
    <div id="gameArea" class="absolute inset-0 pointer-events-none">
        <!-- Bubbles will be dynamically added here -->
    </div>

    <!-- Footer -->
    <footer class="absolute bottom-0 left-0 right-0 z-10 minecraft-panel border-t-4 border-black">
        <div class="max-w-6xl mx-auto px-6 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="text-yellow-300 text-sm mb-2 md:mb-0" style="font-family: 'Courier New', monospace; text-shadow: 1px 1px 0 #333;">
                    © 2025 BlockBreaker.com - The Ultimate Mining Experience. Crafted with ❤️ for miners everywhere.
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="text-yellow-300 hover:text-yellow-400 transition-colors" style="text-shadow: 1px 1px 0 #333;">PRIVACY</a>
                    <a href="#" class="text-yellow-300 hover:text-yellow-400 transition-colors" style="text-shadow: 1px 1px 0 #333;">TERMS</a>
                    <a href="#" class="text-yellow-300 hover:text-yellow-400 transition-colors" style="text-shadow: 1px 1px 0 #333;">CONTACT</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let blockCount = 0;
        let currentLevel = 1;
        let currentBiome = 'overworld';
        let gameActive = false;
        let blockInterval;
        let activeBlocks = [];
        let miningDisabled = false; // Track if mining is temporarily disabled during confetti
        const gameArea = document.getElementById('gameArea');
        const counter = document.getElementById('counter');
        const compactCounter = document.getElementById('compactCounter');
        const startBtn = document.getElementById('startGame');
        const stopBtn = document.getElementById('stopGame');
        const resetBtn = document.getElementById('resetGame');
        const compactStopBtn = document.getElementById('compactStopGame');
        const compactResetBtn = document.getElementById('compactResetGame');
        const musicToggleBtn = document.getElementById('musicToggle');
        const compactMusicToggleBtn = document.getElementById('compactMusicToggle');
        const body = document.body;
        const nav = document.querySelector('nav');
        const backgroundMusic = document.getElementById('backgroundMusic');
        const blockBreakSound = document.getElementById('blockBreakSound');
        
        // Music settings
        let musicEnabled = true;

        // Progression system - biomes unlock at different score milestones
        const biomeProgression = [
            // Overworld Biomes - Plains
            { name: 'overworld', threshold: 0, className: 'bg-overworld', displayName: 'Overworld' },
            { name: 'plains', threshold: 50, className: 'bg-plains', displayName: 'Plains' },
            { name: 'sunflower-plains', threshold: 100, className: 'bg-sunflower-plains', displayName: 'Sunflower Plains' },
            { name: 'snowy-plains', threshold: 175, className: 'bg-snowy-plains', displayName: 'Snowy Plains' },
            { name: 'ice-plains', threshold: 275, className: 'bg-ice-plains', displayName: 'Ice Plains' },
            { name: 'ice-spikes', threshold: 400, className: 'bg-ice-spikes', displayName: 'Ice Spike Plains' },
            
            // Woodlands
            { name: 'forest', threshold: 550, className: 'bg-forest', displayName: 'Forest' },
            { name: 'birch-forest', threshold: 725, className: 'bg-birch-forest', displayName: 'Birch Forest' },
            { name: 'old-birch', threshold: 925, className: 'bg-old-birch', displayName: 'Old Growth Birch Forest' },
            { name: 'flower-forest', threshold: 1150, className: 'bg-flower-forest', displayName: 'Flower Forest' },
            { name: 'dark-forest', threshold: 1400, className: 'bg-dark-forest', displayName: 'Dark Forest' },
            { name: 'taiga', threshold: 1675, className: 'bg-taiga', displayName: 'Taiga' },
            { name: 'snowy-taiga', threshold: 1975, className: 'bg-snowy-taiga', displayName: 'Snowy Taiga' },
            { name: 'old-spruce', threshold: 2300, className: 'bg-old-spruce', displayName: 'Old Growth Spruce Taiga' },
            { name: 'old-pine', threshold: 2650, className: 'bg-old-pine', displayName: 'Old Growth Pine Taiga' },
            { name: 'jungle', threshold: 3025, className: 'bg-jungle', displayName: 'Jungle' },
            { name: 'bamboo-jungle', threshold: 3425, className: 'bg-bamboo-jungle', displayName: 'Bamboo Jungle' },
            { name: 'sparse-jungle', threshold: 3850, className: 'bg-sparse-jungle', displayName: 'Sparse Jungle' },
            { name: 'grove', threshold: 4300, className: 'bg-grove', displayName: 'Grove' },
            { name: 'cherry-grove', threshold: 4775, className: 'bg-cherry-grove', displayName: 'Cherry Grove' },
            { name: 'pale-garden', threshold: 5275, className: 'bg-pale-garden', displayName: 'Pale Garden' },
            
            // Mountains
            { name: 'windswept-hills', threshold: 5800, className: 'bg-windswept-hills', displayName: 'Windswept Hills' },
            { name: 'windswept-forest', threshold: 6350, className: 'bg-windswept-forest', displayName: 'Windswept Forest' },
            { name: 'windswept-gravelly', threshold: 6925, className: 'bg-windswept-gravelly', displayName: 'Windswept Gravelly Hills' },
            { name: 'meadow', threshold: 7525, className: 'bg-meadow', displayName: 'Meadow' },
            { name: 'snowy-slopes', threshold: 8150, className: 'bg-snowy-slopes', displayName: 'Snowy Slopes' },
            { name: 'jagged-peaks', threshold: 8800, className: 'bg-jagged-peaks', displayName: 'Jagged Peaks' },
            { name: 'frozen-peaks', threshold: 9475, className: 'bg-frozen-peaks', displayName: 'Frozen Peaks' },
            { name: 'stony-peaks', threshold: 10175, className: 'bg-stony-peaks', displayName: 'Stony Peaks' },
            { name: 'stony-shores', threshold: 10900, className: 'bg-stony-shores', displayName: 'Stony Shores' },
            
            // Sandy/Desert Areas
            { name: 'desert', threshold: 11650, className: 'bg-desert', displayName: 'Desert' },
            { name: 'badlands', threshold: 12425, className: 'bg-badlands', displayName: 'Badlands' },
            { name: 'wooded-badlands', threshold: 13225, className: 'bg-wooded-badlands', displayName: 'Wooded Badlands' },
            { name: 'eroded-badlands', threshold: 14050, className: 'bg-eroded-badlands', displayName: 'Eroded Badlands' },
            { name: 'beach', threshold: 14900, className: 'bg-beach', displayName: 'Beach' },
            { name: 'snowy-beach', threshold: 15775, className: 'bg-snowy-beach', displayName: 'Snowy Beach' },
            
            // Special Overworld
            { name: 'savanna', threshold: 16675, className: 'bg-savanna', displayName: 'Savanna' },
            { name: 'savanna-plateau', threshold: 17600, className: 'bg-savanna-plateau', displayName: 'Savanna Plateau' },
            { name: 'windswept-savanna', threshold: 18550, className: 'bg-windswept-savanna', displayName: 'Windswept Savanna' },
            { name: 'swamp', threshold: 19525, className: 'bg-swamp', displayName: 'Swamp' },
            { name: 'mangrove-swamp', threshold: 20525, className: 'bg-mangrove-swamp', displayName: 'Mangrove Swamp' },
            { name: 'mushroom-field', threshold: 21550, className: 'bg-mushroom-field', displayName: 'Mushroom Fields' },
            
            // Water Areas
            { name: 'river', threshold: 22600, className: 'bg-river', displayName: 'River' },
            { name: 'frozen-river', threshold: 23675, className: 'bg-frozen-river', displayName: 'Frozen River' },
            { name: 'ocean', threshold: 24775, className: 'bg-ocean', displayName: 'Ocean' },
            { name: 'cold-ocean', threshold: 25900, className: 'bg-cold-ocean', displayName: 'Cold Ocean' },
            { name: 'lukewarm-ocean', threshold: 27050, className: 'bg-lukewarm-ocean', displayName: 'Lukewarm Ocean' },
            { name: 'warm-ocean', threshold: 28225, className: 'bg-warm-ocean', displayName: 'Warm Ocean' },
            { name: 'deep-ocean', threshold: 29425, className: 'bg-deep-ocean', displayName: 'Deep Ocean' },
            { name: 'frozen-ocean', threshold: 30650, className: 'bg-frozen-ocean', displayName: 'Frozen Ocean' },
            
            // Cave Biomes
            { name: 'cave', threshold: 31900, className: 'bg-cave', displayName: 'Caves' },
            { name: 'dripstone-caves', threshold: 33175, className: 'bg-dripstone-caves', displayName: 'Dripstone Caves' },
            { name: 'lush-caves', threshold: 34475, className: 'bg-lush-caves', displayName: 'Lush Caves' },
            { name: 'deep-dark', threshold: 35800, className: 'bg-deep-dark', displayName: 'Deep Dark' },
            
            // Nether Biomes
            { name: 'nether-wastes', threshold: 37150, className: 'bg-nether-wastes', displayName: 'Nether Wastes' },
            { name: 'soul-sand-valley', threshold: 38525, className: 'bg-soul-sand-valley', displayName: 'Soul Sand Valley' },
            { name: 'basalt-deltas', threshold: 39925, className: 'bg-basalt-deltas', displayName: 'Basalt Deltas' },
            { name: 'crimson-forest', threshold: 41350, className: 'bg-crimson-forest', displayName: 'Crimson Forest' },
            { name: 'warped-forest', threshold: 42800, className: 'bg-warped-forest', displayName: 'Warped Forest' },
            
            // End Biomes
            { name: 'end', threshold: 44275, className: 'bg-end', displayName: 'The End' },
            { name: 'end-barrens', threshold: 45775, className: 'bg-end-barrens', displayName: 'End Barrens' },
            { name: 'end-midlands', threshold: 47300, className: 'bg-end-midlands', displayName: 'End Midlands' },
            { name: 'end-highlands', threshold: 48850, className: 'bg-end-highlands', displayName: 'End Highlands' },
            { name: 'small-end-islands', threshold: 50425, className: 'bg-small-end-islands', displayName: 'Small End Islands' },
            
            // Secret Final Biomes
            { name: 'real-end', threshold: 52025, className: 'bg-real-end', displayName: 'The True End' },
            { name: 'blood-level', threshold: 55000, className: 'bg-blood-level', displayName: 'Blood Dimension' }
        ];

        // Minecraft block types and colors
        const blockTypes = [
            { name: 'dirt', color: '#8B4513', rarity: 'common' },
            { name: 'stone', color: '#708090', rarity: 'common' },
            { name: 'coal', color: '#2F4F4F', rarity: 'common' },
            { name: 'iron', color: '#D2691E', rarity: 'uncommon' },
            { name: 'gold', color: '#FFD700', rarity: 'rare' },
            { name: 'diamond', color: '#00CED1', rarity: 'very-rare' },
            { name: 'emerald', color: '#50C878', rarity: 'very-rare' },
            { name: 'netherite', color: '#000000', rarity: 'legendary' },
            { name: 'obsidian', color: '#36013F', rarity: 'uncommon' },
            // Ultra-rare special blocks - 0.01% chance each, worth 50 points
            { name: 'ender-dragon-egg', color: '#1A1A2E', rarity: 'ultra-rare' },
            { name: 'enchanted-golden-apple', color: '#FFDD44', rarity: 'ultra-rare' },
            { name: 'music-disc-pigstep', color: '#8B4513', rarity: 'ultra-rare' },
            { name: 'netherite-hoe', color: '#2D2D2D', rarity: 'ultra-rare' },
            { name: 'skeleton-horse', color: '#F5F5DC', rarity: 'ultra-rare' },
            // Bomb blocks - 0.20% chance, decrease points by 10
            { name: 'bomb', color: '#8B4513', rarity: 'bomb' }
        ];

        function getRandomBlock() {
            const rand = Math.random();
            
            // Progressive probability system based on current level/biome
            // Get progression multiplier (1.0 to 3.0 based on level)
            const progressionMultiplier = Math.min(1.0 + (currentLevel - 1) * 0.1, 3.0);
            
            // Base rates that scale with progression
            let ultraRareRate = 0.0005 * progressionMultiplier;
            let bombRate = Math.max(0.002 - (currentLevel - 1) * 0.0001, 0.0005); // Bombs become rarer as you progress
            let baseCommon = Math.max(0.6 - (currentLevel - 1) * 0.02, 0.3); // Commons become rarer
            let baseUncommon = 0.25 + (currentLevel - 1) * 0.005;
            let baseRare = 0.10 + (currentLevel - 1) * 0.01;
            let baseEmerald = 0.015 + (currentLevel - 1) * 0.002;
            let baseDiamond = 0.0075 + (currentLevel - 1) * 0.002;
            let baseNetherite = 0.005 + (currentLevel - 1) * 0.001;
            
            // Special biome modifiers
            if (currentBiome.includes('nether')) {
                // Nether biomes: more rare blocks, fewer commons
                baseCommon *= 0.7;
                baseRare *= 1.5;
                baseDiamond *= 1.3;
                baseNetherite *= 2.0;
            } else if (currentBiome.includes('end')) {
                // End biomes: extremely rare blocks more common
                ultraRareRate *= 3.0;
                baseNetherite *= 1.8;
                baseDiamond *= 1.5;
                baseCommon *= 0.5;
            } else if (currentBiome === 'deep-dark') {
                // Deep Dark: balanced rare block rates
                baseRare *= 1.3;
                baseDiamond *= 1.4;
                baseNetherite *= 1.2;
            } else if (currentBiome === 'blood-level') {
                // Blood Level: maximum rarity
                ultraRareRate *= 5.0;
                baseNetherite *= 3.0;
                baseDiamond *= 2.0;
                baseCommon *= 0.3;
                bombRate *= 0.1; // Almost no bombs in blood level
            }
            
            // Normalize probabilities
            const total = baseCommon + baseUncommon + baseRare + baseEmerald + baseDiamond + baseNetherite + ultraRareRate + bombRate;
            if (total > 1.0) {
                const scale = 0.98 / total;
                baseCommon *= scale;
                baseUncommon *= scale;
                baseRare *= scale;
                baseEmerald *= scale;
                baseDiamond *= scale;
                baseNetherite *= scale;
                ultraRareRate *= scale;
                bombRate *= scale;
            }
            
            if (rand < baseCommon) {
                return blockTypes.filter(b => b.rarity === 'common')[Math.floor(Math.random() * 3)];
            } else if (rand < baseCommon + baseUncommon) {
                return blockTypes.filter(b => b.rarity === 'uncommon')[Math.floor(Math.random() * 2)];
            } else if (rand < baseCommon + baseUncommon + baseRare) {
                return blockTypes.filter(b => b.rarity === 'rare')[0];
            } else if (rand < baseCommon + baseUncommon + baseRare + baseEmerald) {
                return blockTypes.filter(b => b.name === 'emerald')[0];
            } else if (rand < baseCommon + baseUncommon + baseRare + baseEmerald + baseDiamond) {
                return blockTypes.filter(b => b.name === 'diamond')[0];
            } else if (rand < baseCommon + baseUncommon + baseRare + baseEmerald + baseDiamond + baseNetherite) {
                return blockTypes.filter(b => b.name === 'netherite')[0];
            } else if (rand < baseCommon + baseUncommon + baseRare + baseEmerald + baseDiamond + baseNetherite + ultraRareRate) {
                const ultraRareBlocks = blockTypes.filter(b => b.rarity === 'ultra-rare');
                return ultraRareBlocks[Math.floor(Math.random() * ultraRareBlocks.length)];
            } else if (rand < baseCommon + baseUncommon + baseRare + baseEmerald + baseDiamond + baseNetherite + ultraRareRate + bombRate) {
                // Bomb blocks (decreasing chance with progression)
                return blockTypes.filter(b => b.rarity === 'bomb')[0];
            } else {
                return blockTypes.filter(b => b.rarity === 'common')[Math.floor(Math.random() * 3)];
            }
        }

        function createBlock() {
            if (!gameActive) return;

            // Only create new blocks if we have less than 5 active blocks
            if (activeBlocks.length >= 5) return;

            const blockType = getRandomBlock();
            const block = document.createElement('div');
            block.className = 'bubble pointer-events-auto';
            
            // Square blocks like Minecraft
            const size = Math.random() * 30 + 40; // 40-70px
            
            // Make blocks larger on mobile for better touch targets
            const isMobile = window.innerWidth <= 768;
            const adjustedSize = isMobile ? Math.max(size, 50) : size;
            
            block.style.width = adjustedSize + 'px';
            block.style.height = adjustedSize + 'px';
            
            // Center-based positioning
            const centerWidth = window.innerWidth * 0.6;
            const centerStart = window.innerWidth * 0.2;
            const safeMarginTop = gameActive ? 60 : window.innerHeight * 0.15;
            const safeMarginBottom = window.innerHeight * 0.15;
            
            // Adjust safe margins for mobile
            const adjustedSafeMarginTop = isMobile && gameActive ? 100 : safeMarginTop;
            const adjustedSafeMarginBottom = isMobile ? window.innerHeight * 0.1 : safeMarginBottom;
            
            const safeHeight = window.innerHeight - adjustedSafeMarginTop - adjustedSafeMarginBottom - adjustedSize;
            const safeWidth = centerWidth - adjustedSize;
            
            block.style.left = (centerStart + Math.random() * safeWidth) + 'px';
            block.style.top = (adjustedSafeMarginTop + Math.random() * safeHeight) + 'px';
            
            // Minecraft block styling
            block.style.background = blockType.color;
            block.style.borderRadius = '0px';
            
            // Add texture pattern
            block.style.backgroundImage = `
                linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%),
                linear-gradient(-45deg, rgba(255,255,255,0.1) 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, rgba(0,0,0,0.1) 75%),
                linear-gradient(-45deg, transparent 75%, rgba(0,0,0,0.1) 75%)
            `;
            block.style.backgroundSize = '8px 8px';
            
            // Add click and touch event handlers
            const handleMineBlock = function(e) {
                e.preventDefault();
                e.stopPropagation();
                if (miningDisabled) {
                    return;
                }
                mineBlock(block, blockType);
            };
            
            // Mouse events
            block.addEventListener('click', handleMineBlock);
            
            // Touch events for mobile support
            block.addEventListener('touchstart', function(e) {
                e.preventDefault();
                e.stopPropagation();
                // Add visual feedback for touch
                block.classList.add('touch-feedback');
            }, { passive: false });
            
            block.addEventListener('touchend', function(e) {
                e.preventDefault();
                e.stopPropagation();
                // Remove visual feedback
                block.classList.remove('touch-feedback');
                // Mine the block if mining is not disabled
                if (!miningDisabled) {
                    mineBlock(block, blockType);
                }
            }, { passive: false });
            
            block.addEventListener('touchcancel', function(e) {
                e.preventDefault();
                e.stopPropagation();
                // Remove visual feedback if touch is cancelled
                block.classList.remove('touch-feedback');
            }, { passive: false });
            
            block.setAttribute('data-block-type', blockType.name);
            
            gameArea.appendChild(block);
            activeBlocks.push(block);
            
            // Remove block after 6 seconds if not mined
            setTimeout(() => {
                if (block.parentNode) {
                    removeBlockFromActive(block);
                    block.remove();
                }
            }, 6000);
        }

        function removeBlockFromActive(block) {
            const index = activeBlocks.indexOf(block);
            if (index > -1) {
                activeBlocks.splice(index, 1);
            }
        }

        function removeBombBlocks() {
            // Find all bomb blocks in the game area and remove them
            const bombBlocks = gameArea.querySelectorAll('[data-block-type="bomb"]');
            bombBlocks.forEach(bombBlock => {
                // Add a quick fade-out animation before removing
                bombBlock.style.transition = 'opacity 0.3s ease-out';
                bombBlock.style.opacity = '0';
                
                // Remove from active blocks array
                removeBlockFromActive(bombBlock);
                
                // Remove from DOM after animation
                setTimeout(() => {
                    if (bombBlock.parentNode) {
                        bombBlock.remove();
                    }
                }, 300);
            });
        }

        function mineBlock(block, blockType) {
            // Prevent multiple clicks
            if (block.classList.contains('pop-animation') || block.classList.contains('big-pop-animation')) return;
            
            // Play block break sound effect
            if (blockBreakSound) {
                blockBreakSound.currentTime = 0; // Reset to start for rapid clicks
                blockBreakSound.volume = 0.7; // Set volume to 70%
                blockBreakSound.play().catch(e => {
                    console.log('Could not play block break sound:', e);
                });
            }
            
            // Add haptic feedback for mobile devices
            addHapticFeedback();
            
            // Remove from active blocks array
            removeBlockFromActive(block);
            
            // If this is NOT a bomb block, remove all bomb blocks from the game area
            if (blockType.rarity !== 'bomb') {
                removeBombBlocks();
            }
            
            // Add bonus points for rare blocks
            let bonus = 1;
            if (blockType.rarity === 'uncommon') bonus = 2;
            if (blockType.rarity === 'rare') bonus = 5;
            if (blockType.rarity === 'very-rare') {
                bonus = (blockType.name === 'emerald') ? 8 : 10;
            }
            if (blockType.rarity === 'legendary') bonus = 20;
            if (blockType.rarity === 'ultra-rare') bonus = 50;
            if (blockType.rarity === 'bomb') bonus = -10; // Bomb blocks decrease points by 10
            
            // Use big animation for high-value blocks, normal for bomb blocks
            if (bonus >= 10) {
                block.classList.add('big-pop-animation');
                createSparkleEffect(block);
                createShockwave(block);
                
                // Add fireworks effect for blocks worth more than 49 points
                if (bonus > 49) {
                    createFireworksEffect(block);
                }
                
                createRainbowConfetti(blockType.name);
            } else if (blockType.rarity === 'bomb') {
                // Special handling for bomb blocks - use normal animation but crying confetti
                block.classList.add('pop-animation');
                createCryingConfetti(); // Use crying emoji confetti for bomb blocks
            } else {
                block.classList.add('pop-animation');
            }
            
            // Handle bomb blocks reducing the count
            if (blockType.rarity === 'bomb') {
                blockCount = Math.max(0, blockCount - 10); // Decrease by 10, minimum 0
                updateCounterDisplay(blockCount);
                showBonus(block, 'BOMB ' + bonus); // Show negative bonus
            } else {
                blockCount++;
                updateCounterDisplay(blockCount);
                
                if (bonus > 1) {
                    blockCount += bonus - 1;
                    updateCounterDisplay(blockCount);
                    showBonus(block, blockType.name.toUpperCase() + ' +' + bonus);
                }
            }
            
            // Check for progression after updating the score
            checkProgression();
            
            // Celebration effect for milestones
            if (blockCount % 25 === 0) {
                celebrateScore();
            }
            
            // Remove block after animation
            const animationDuration = bonus >= 10 ? 600 : 400;
            setTimeout(() => {
                if (block.parentNode) {
                    block.remove();
                }
            }, animationDuration);
        }

        function createSparkleEffect(block) {
            const centerX = parseInt(block.style.left) + parseInt(block.style.width) / 2;
            const centerY = parseInt(block.style.top) + parseInt(block.style.height) / 2;
            
            for (let i = 0; i < 8; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle-effect';
                
                const angle = (i / 8) * 360;
                const distance = 30 + Math.random() * 20;
                const x = centerX + Math.cos(angle * Math.PI / 180) * distance;
                const y = centerY + Math.sin(angle * Math.PI / 180) * distance;
                
                sparkle.style.left = x + 'px';
                sparkle.style.top = y + 'px';
                sparkle.style.animationDelay = (i * 0.1) + 's';
                
                gameArea.appendChild(sparkle);
                
                setTimeout(() => {
                    sparkle.remove();
                }, 1000);
            }
        }

        function createShockwave(block) {
            const shockwave = document.createElement('div');
            shockwave.style.position = 'absolute';
            shockwave.style.left = block.style.left;
            shockwave.style.top = block.style.top;
            shockwave.style.width = block.style.width;
            shockwave.style.height = block.style.height;
            shockwave.style.borderRadius = '50%';
            shockwave.style.border = '3px solid #FFD700';
            shockwave.style.pointerEvents = 'none';
            shockwave.style.zIndex = '1500';
            shockwave.style.animation = 'shockwave 0.6s ease-out forwards';
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes shockwave {
                    0% { transform: scale(1); opacity: 1; }
                    100% { transform: scale(4); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            gameArea.appendChild(shockwave);
            
            setTimeout(() => {
                shockwave.remove();
                style.remove();
            }, 600);
        }

        function createFireworksEffect(block) {
            const centerX = parseInt(block.style.left) + parseInt(block.style.width) / 2;
            const centerY = parseInt(block.style.top) + parseInt(block.style.height) / 2;
            
            const fireworkColors = [
                '#FF0040', '#FF4000', '#FFFF00', '#40FF00', '#0040FF', 
                '#8000FF', '#FF0080', '#FF8000', '#00FF80', '#0080FF',
                '#FFD700', '#FF1493', '#00CED1', '#32CD32', '#FF6347'
            ];
            
            for (let explosion = 0; explosion < 5; explosion++) {
                setTimeout(() => {
                    const explosionX = centerX + (Math.random() - 0.5) * 200;
                    const explosionY = centerY + (Math.random() - 0.5) * 200;
                    
                    for (let particle = 0; particle < 15; particle++) {
                        const firework = document.createElement('div');
                        firework.className = 'firework-particle';
                        
                        const color = fireworkColors[Math.floor(Math.random() * fireworkColors.length)];
                        firework.style.background = color;
                        firework.style.boxShadow = `0 0 20px ${color}`;
                        
                        const size = Math.random() * 8 + 4;
                        firework.style.width = size + 'px';
                        firework.style.height = size + 'px';
                        firework.style.position = 'absolute';
                        firework.style.borderRadius = '50%';
                        firework.style.zIndex = '9999';
                        firework.style.pointerEvents = 'none';
                        
                        firework.style.left = explosionX + 'px';
                        firework.style.top = explosionY + 'px';
                        
                        const angle = (particle / 15) * Math.PI * 2;
                        const distance = Math.random() * 150 + 50;
                        const xDistance = Math.cos(angle) * distance;
                        const yDistance = Math.sin(angle) * distance;
                        
                        firework.style.setProperty('--x-distance', xDistance + 'px');
                        firework.style.setProperty('--y-distance', yDistance + 'px');
                        
                        firework.style.animation = `fireworkExplode 1.5s ease-out forwards`;
                        firework.style.animationDelay = (Math.random() * 0.2) + 's';
                        
                        gameArea.appendChild(firework);
                        
                        setTimeout(() => {
                            if (firework.parentNode) firework.remove();
                        }, 2000);
                    }
                }, explosion * 200);
            }
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fireworkExplode {
                    0% { 
                        transform: translate(0, 0) scale(1);
                        opacity: 1;
                    }
                    50% { 
                        transform: translate(calc(var(--x-distance) * 0.5), calc(var(--y-distance) * 0.5)) scale(1.2);
                        opacity: 1;
                    }
                    100% { 
                        transform: translate(var(--x-distance), var(--y-distance)) scale(0.3);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            setTimeout(() => {
                style.remove();
            }, 3000);
        }

        function createRainbowConfetti(blockType) {
            miningDisabled = true;
            
            const colors = ['#FF0000', '#FF7F00', '#FFFF00', '#00FF00', '#0000FF', '#4B0082', '#9400D3', '#FF69B4', '#00FFFF', '#FFA500'];
            
            let confettiCount, animationDuration, totalEffectDuration;
            if (blockType === 'diamond') {
                confettiCount = 300;
                animationDuration = 3000;
                totalEffectDuration = 5000;
            } else if (blockType === 'netherite') {
                confettiCount = 500;
                animationDuration = 4000;
                totalEffectDuration = 6000;
            } else {
                confettiCount = 150;
                animationDuration = 3000;
                totalEffectDuration = 5000;
            }
            
            const burstCount = 3;
            
            for (let burst = 0; burst < burstCount; burst++) {
                setTimeout(() => {
                    const burstX = Math.random() * (window.innerWidth * 0.9) + (window.innerWidth * 0.05);
                    const burstY = Math.random() * (window.innerHeight * 0.7) + (window.innerHeight * 0.15);
                    
                    const particlesPerBurst = Math.floor(confettiCount / burstCount);
                    const batchFragment = document.createDocumentFragment();
                    
                    for (let i = 0; i < particlesPerBurst; i++) {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        
                        const randomColor = colors[Math.floor(Math.random() * colors.length)];
                        confetti.style.background = randomColor;
                        confetti.style.borderRadius = '50%';
                        
                        const size = Math.random() * 6 + 4;
                        confetti.style.width = size + 'px';
                        confetti.style.height = size + 'px';
                        confetti.style.position = 'absolute';
                        confetti.style.zIndex = '9999';
                        confetti.style.pointerEvents = 'none';
                        
                        confetti.style.left = burstX + 'px';
                        confetti.style.top = burstY + 'px';
                        
                        const angle = Math.random() * Math.PI * 2;
                        const distance = Math.random() * 300 + 100;
                        const xDistance = Math.cos(angle) * distance;
                        const yDistance = Math.sin(angle) * distance + (Math.random() * 80 + 40);
                        
                        confetti.style.setProperty('--x-distance', xDistance + 'px');
                        confetti.style.setProperty('--y-distance', yDistance + 'px');
                        confetti.style.animation = `confettiFall ${animationDuration}ms ease-out forwards`;
                        confetti.style.animationDelay = (Math.random() * 0.1) + 's';
                        
                        batchFragment.appendChild(confetti);
                    }
                    
                    gameArea.appendChild(batchFragment);
                    
                    setTimeout(() => {
                        const confettiElements = gameArea.querySelectorAll('.confetti');
                        confettiElements.forEach(element => {
                            if (element.parentNode) element.remove();
                        });
                    }, animationDuration);
                    
                }, burst * 300);
            }
            
            const style = document.createElement('style');
            style.textContent = `
                @keyframes confettiFall {
                    0% { 
                        transform: translate(0, 0) rotate(0deg);
                        opacity: 1;
                    }
                    100% { 
                        transform: translate(var(--x-distance), var(--y-distance)) rotate(720deg);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            setTimeout(() => {
                miningDisabled = false;
                style.remove();
            }, totalEffectDuration);
        }

        function showBonus(block, text) {
            const bonus = document.createElement('div');
            bonus.textContent = text;
            bonus.style.position = 'absolute';
            bonus.style.left = block.style.left;
            bonus.style.top = (parseInt(block.style.top) - 20) + 'px';
            bonus.style.color = '#FFD700';
            bonus.style.fontWeight = 'bold';
            bonus.style.fontSize = '14px';
            bonus.style.fontFamily = 'Courier New, monospace';
            bonus.style.textShadow = '2px 2px 0 #333';
            bonus.style.zIndex = '2000';
            bonus.style.pointerEvents = 'none';
            bonus.style.animation = 'float 1s ease-out forwards';
            
            gameArea.appendChild(bonus);
            
            setTimeout(() => {
                bonus.remove();
            }, 1000);
        }

        function createCryingConfetti() {
            // Create crying emoji confetti for bomb blocks
            const cryingEmojis = ['😭', '😢', '💔', '😿', '😞'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const emoji = document.createElement('div');
                    emoji.textContent = cryingEmojis[Math.floor(Math.random() * cryingEmojis.length)];
                    emoji.style.position = 'fixed';
                    emoji.style.fontSize = '20px';
                    emoji.style.left = Math.random() * window.innerWidth + 'px';
                    emoji.style.top = '-30px';
                    emoji.style.zIndex = '9999';
                    emoji.style.pointerEvents = 'none';
                    emoji.style.animation = 'cryingFall 2s ease-out forwards';
                    
                    document.body.appendChild(emoji);
                    
                    setTimeout(() => {
                        emoji.remove();
                    }, 2000);
                }, i * 50);
            }
            
            // Add crying animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes cryingFall {
                    0% { 
                        transform: translateY(0) rotate(0deg);
                        opacity: 1;
                    }
                    100% { 
                        transform: translateY(100vh) rotate(180deg);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            setTimeout(() => {
                style.remove();
            }, 2000);
        }

        function celebrateScore() {
            counter.style.transform = 'scale(1.5)';
            counter.style.color = '#00FF00';
            setTimeout(() => {
                counter.style.transform = 'scale(1)';
                counter.style.color = '#FFFF00';
            }, 500);
        }

        function checkProgression() {
            // Find the highest biome the player has unlocked
            let newBiome = biomeProgression[0];
            let newLevel = 1;
            
            for (let i = biomeProgression.length - 1; i >= 0; i--) {
                if (blockCount >= biomeProgression[i].threshold) {
                    newBiome = biomeProgression[i];
                    newLevel = i + 1;
                    break;
                }
            }
            
            // Check if we've progressed to a new biome
            if (newBiome.name !== currentBiome) {
                const oldBiome = currentBiome;
                currentBiome = newBiome.name;
                currentLevel = newLevel;
                
                // Update background
                updateBiomeBackground(newBiome.className);
                
                // Show biome unlock notification
                showBiomeUnlockNotification(newBiome.displayName, oldBiome);
                
                // Celebrate level up
                celebrateLevelUp();
            }
        }

        function updateBiomeBackground(newBiomeClass) {
            // Remove all existing biome classes
            biomeProgression.forEach(biome => {
                body.classList.remove(biome.className);
            });
            
            // Add the new biome class
            body.classList.add(newBiomeClass);
        }

        function showBiomeUnlockNotification(biomeName, oldBiome) {
            // Update biome display elements
            const biomeDisplay = document.getElementById('biomeDisplay');
            const compactBiomeDisplay = document.getElementById('compactBiomeDisplay');
            if (biomeDisplay) biomeDisplay.textContent = biomeName;
            if (compactBiomeDisplay) compactBiomeDisplay.textContent = biomeName;
            
            // Update next biome display
            updateNextBiomeDisplay();
            
            // Create notification element
            const notification = document.createElement('div');
            notification.innerHTML = `
                <div class="text-center">
                    <div class="text-2xl font-bold text-yellow-300 mb-2" style="text-shadow: 2px 2px 0 #333;">
                        🌍 BIOME UNLOCKED! 🌍
                    </div>
                    <div class="text-xl text-green-400 font-bold" style="text-shadow: 1px 1px 0 #333;">
                        ${biomeName}
                    </div>
                    <div class="text-sm text-yellow-200 mt-2" style="text-shadow: 1px 1px 0 #333;">
                        Rare blocks are now more common!
                    </div>
                </div>
            `;
            
            notification.style.position = 'fixed';
            notification.style.top = '50%';
            notification.style.left = '50%';
            notification.style.transform = 'translate(-50%, -50%)';
            notification.style.zIndex = '10000';
            notification.style.background = 'rgba(0, 0, 0, 0.9)';
            notification.style.border = '3px solid #FFD700';
            notification.style.borderRadius = '12px';
            notification.style.padding = '20px 30px';
            notification.style.backdropFilter = 'blur(10px)';
            notification.style.animation = 'biomeUnlock 4s ease-in-out forwards';
            notification.style.fontFamily = 'Courier New, monospace';
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes biomeUnlock {
                    0% { 
                        opacity: 0;
                        transform: translate(-50%, -50%) scale(0.5);
                    }
                    15% { 
                        opacity: 1;
                        transform: translate(-50%, -50%) scale(1.1);
                    }
                    25% { 
                        transform: translate(-50%, -50%) scale(1);
                    }
                    85% { 
                        opacity: 1;
                        transform: translate(-50%, -50%) scale(1);
                    }
                    100% { 
                        opacity: 0;
                        transform: translate(-50%, -50%) scale(0.8);
                    }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
                style.remove();
            }, 4000);
        }

        function updateNextBiomeDisplay() {
            const nextBiomeDisplay = document.getElementById('nextBiomeDisplay');
            if (!nextBiomeDisplay) return;
            
            // Find the next biome in progression
            let nextBiome = null;
            for (let i = 0; i < biomeProgression.length; i++) {
                if (blockCount < biomeProgression[i].threshold) {
                    nextBiome = biomeProgression[i];
                    break;
                }
            }
            
            if (nextBiome) {
                const remaining = nextBiome.threshold - blockCount;
                nextBiomeDisplay.textContent = `${nextBiome.displayName} (${remaining} blocks)`;
            } else {
                nextBiomeDisplay.textContent = 'Max Level Reached!';
            }
        }

        function celebrateLevelUp() {
            // Create level up confetti
            const colors = ['#FFD700', '#00FF00', '#FF4500', '#FF1493', '#00CED1'];
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.style.position = 'fixed';
                    confetti.style.width = '10px';
                    confetti.style.height = '10px';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0%';
                    confetti.style.left = Math.random() * window.innerWidth + 'px';
                    confetti.style.top = '-20px';
                    confetti.style.zIndex = '9999';
                    confetti.style.pointerEvents = 'none';
                    confetti.style.animation = 'levelUpConfetti 3s ease-out forwards';
                    
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000);
                }, i * 20);
            }
            
            // Add confetti animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes levelUpConfetti {
                    0% { 
                        transform: translateY(0) rotate(0deg);
                        opacity: 1;
                    }
                    100% { 
                        transform: translateY(100vh) rotate(720deg);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            setTimeout(() => {
                style.remove();
            }, 3000);
        }

        function updateCounterDisplay(count) {
            if (counter) counter.textContent = count;
            if (compactCounter) compactCounter.textContent = count;
            
            // Update next biome display whenever score changes
            updateNextBiomeDisplay();
        }

        function startDynamicBlockSpawning() {
            function spawnBlock() {
                createBlock();
                
                // Calculate dynamic spawn rate based on progression
                // Base rate: 300ms, gets faster with progression (min 150ms)
                let baseRate = 300;
                let progressionBonus = Math.min(currentLevel * 5, 150); // Faster spawning as you progress
                let spawnRate = Math.max(baseRate - progressionBonus, 150);
                
                // Special biome modifiers
                if (currentBiome.includes('nether') || currentBiome.includes('end')) {
                    spawnRate *= 0.8; // 20% faster in dangerous biomes
                }
                
                if (gameActive) {
                    blockInterval = setTimeout(spawnBlock, spawnRate);
                }
            }
            
            spawnBlock(); // Start the spawning cycle
        }

        function startGame() {
            gameActive = true;
            miningDisabled = false; // Reset mining disabled flag
            startBtn.textContent = '⛏️ MINING ACTIVE!';
            startBtn.disabled = true;
            startBtn.classList.add('opacity-50');
            
            // Start background music if enabled
            if (backgroundMusic && musicEnabled) {
                backgroundMusic.volume = 1.0; // Set volume to 100%
                backgroundMusic.play().catch(e => {
                    console.log('Could not play background music:', e);
                });
            }
            
            // Hide touch hint when game starts
            const touchHint = document.getElementById('touchHint');
            if (touchHint) {
                touchHint.style.display = 'none';
            }
            
            // Add game cursor and game-active class
            document.body.classList.add('game-active-cursor');
            document.body.classList.add('game-active');
            
            // Style navigation for gameplay
            nav.classList.add('nav-gameplay-mode');
            
            // Switch to compact UI layout
            const heroSection = document.getElementById('heroSection');
            heroSection.classList.remove('game-ui-normal');
            heroSection.classList.add('game-ui-compact');
            heroSection.classList.add('animate-entrance');
            
            // Remove animation class after animation completes
            setTimeout(() => {
                heroSection.classList.remove('animate-entrance');
            }, 600);
            
            // Create blocks more frequently since we limit to 5 at a time
            // Start dynamic block spawning based on progression
            startDynamicBlockSpawning();
        }

        function stopGame() {
            gameActive = false;
            miningDisabled = false; // Reset mining disabled flag
            clearTimeout(blockInterval);
            
            // Pause background music
            if (backgroundMusic) {
                backgroundMusic.pause();
            }
            
            // Show touch hint again when game stops on mobile
            const touchHint = document.getElementById('touchHint');
            if (touchHint) {
                touchHint.style.display = 'block';
            }
            
            // Remove game cursor and game-active class
            document.body.classList.remove('game-active-cursor');
            document.body.classList.remove('game-active');
            
            // Reset navigation styling
            nav.classList.remove('nav-gameplay-mode');
            
            // Switch back to normal UI layout
            const heroSection = document.getElementById('heroSection');
            heroSection.classList.remove('game-ui-compact');
            heroSection.classList.add('game-ui-normal');
            
            // Reset start button to allow mining again
            startBtn.textContent = '⛏️ START MINING!';
            startBtn.disabled = false;
            startBtn.classList.remove('opacity-50');
            
            // Remove all active blocks but keep the count
            const blocks = document.querySelectorAll('.bubble');
            blocks.forEach(block => block.remove());
            activeBlocks = []; // Reset active blocks array
        }

        function resetGame() {
            gameActive = false;
            miningDisabled = false; // Reset mining disabled flag
            clearTimeout(blockInterval);
            blockCount = 0;
            currentLevel = 1;
            currentBiome = 'overworld';
            updateCounterDisplay('0');
            activeBlocks = []; // Reset active blocks array
            
            // Reset background to overworld
            updateBiomeBackground('bg-overworld');
            
            // Reset biome display
            const biomeDisplay = document.getElementById('biomeDisplay');
            const compactBiomeDisplay = document.getElementById('compactBiomeDisplay');
            if (biomeDisplay) biomeDisplay.textContent = 'Overworld';
            if (compactBiomeDisplay) compactBiomeDisplay.textContent = 'Overworld';
            
            // Reset next biome display
            updateNextBiomeDisplay();
            
            // Stop and reset background music
            if (backgroundMusic) {
                backgroundMusic.pause();
                backgroundMusic.currentTime = 0;
            }
            
            // Show touch hint again when game resets on mobile
            const touchHint = document.getElementById('touchHint');
            if (touchHint) {
                touchHint.style.display = 'block';
            }
            
            // Remove game cursor and game-active class
            document.body.classList.remove('game-active-cursor');
            document.body.classList.remove('game-active');
            
            // Reset navigation styling
            nav.classList.remove('nav-gameplay-mode');
            
            // Switch back to normal UI layout
            const heroSection = document.getElementById('heroSection');
            heroSection.classList.remove('game-ui-compact');
            heroSection.classList.add('game-ui-normal');
            
            // Remove all blocks
            const blocks = document.querySelectorAll('.bubble');
            blocks.forEach(block => block.remove());
            
            // Reset start button to allow mining again
            startBtn.textContent = '⛏️ START MINING!';
            startBtn.disabled = false;
            startBtn.classList.remove('opacity-50');
            
        }

        function toggleMusic() {
            musicEnabled = !musicEnabled;
            
            if (musicEnabled) {
                musicToggleBtn.textContent = '🎵 MUSIC: ON';
                compactMusicToggleBtn.textContent = '🎵';
                compactMusicToggleBtn.style.backgroundColor = '#7C3AED'; // Purple
                if (gameActive && backgroundMusic) {
                    backgroundMusic.play().catch(e => {
                        console.log('Could not play background music:', e);
                    });
                }
            } else {
                musicToggleBtn.textContent = '🔇 MUSIC: OFF';
                compactMusicToggleBtn.textContent = '🔇';
                compactMusicToggleBtn.style.backgroundColor = '#6B7280'; // Gray
                if (backgroundMusic) {
                    backgroundMusic.pause();
                }
            }
        }

        // Helper function to update both counters
        function updateCounterDisplay(value) {
            counter.textContent = value;
            compactCounter.textContent = value;
        }
        
        // Event listeners
        startBtn.addEventListener('click', startGame);
        stopBtn.addEventListener('click', stopGame);
        resetBtn.addEventListener('click', resetGame);
        compactStopBtn.addEventListener('click', stopGame);
        compactResetBtn.addEventListener('click', resetGame);
        musicToggleBtn.addEventListener('click', toggleMusic);
        compactMusicToggleBtn.addEventListener('click', toggleMusic);
        musicToggleBtn.addEventListener('click', toggleMusic);
        compactMusicToggleBtn.addEventListener('click', toggleMusic);

        // Touch event listeners for buttons to improve mobile experience
        [startBtn, stopBtn, resetBtn, compactStopBtn, compactResetBtn, musicToggleBtn, compactMusicToggleBtn].forEach(btn => {
            if (btn) {
                btn.addEventListener('touchstart', function(e) {
                    this.style.transform = 'scale(0.95)';
                }, { passive: true });
                
                btn.addEventListener('touchend', function(e) {
                    this.style.transform = '';
                }, { passive: true });
                
                btn.addEventListener('touchcancel', function(e) {
                    this.style.transform = '';
                }, { passive: true });
            }
        });

        // Prevent default touch behaviors on game area during gameplay
        gameArea.addEventListener('touchstart', function(e) {
            if (gameActive) {
                e.preventDefault();
            }
        }, { passive: false });

        gameArea.addEventListener('touchmove', function(e) {
            if (gameActive) {
                e.preventDefault();
            }
        }, { passive: false });

        gameArea.addEventListener('touchend', function(e) {
            if (gameActive) {
                e.preventDefault();
            }
        }, { passive: false });

        // Prevent zoom on double tap for the entire document during gameplay
        document.addEventListener('touchstart', function(e) {
            if (gameActive && e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // Prevent context menu on long press during gameplay
        document.addEventListener('contextmenu', function(e) {
            if (gameActive) {
                e.preventDefault();
            }
        });

        // Handle window resize for responsive gameplay
        window.addEventListener('resize', function() {
            // Adjust game area if needed when orientation changes
            if (gameActive) {
                // Remove blocks that might be outside the new viewport
                const blocks = document.querySelectorAll('.bubble');
                blocks.forEach(block => {
                    const rect = block.getBoundingClientRect();
                    if (rect.right > window.innerWidth || rect.bottom > window.innerHeight || rect.left < 0 || rect.top < 0) {
                        removeBlockFromActive(block);
                        block.remove();
                    }
                });
            }
        });

        // Handle orientation change specifically for mobile devices
        window.addEventListener('orientationchange', function() {
            // Wait for the orientation change to complete
            setTimeout(function() {
                if (gameActive) {
                    // Force a layout recalculation and remove out-of-bounds blocks
                    const blocks = document.querySelectorAll('.bubble');
                    blocks.forEach(block => {
                        const rect = block.getBoundingClientRect();
                        if (rect.right > window.innerWidth || rect.bottom > window.innerHeight || rect.left < 0 || rect.top < 0) {
                            removeBlockFromActive(block);
                            block.remove();
                        }
                    });
                }
            }, 500);
        });

        // Add haptic feedback for supported devices
        function addHapticFeedback() {
            if ('vibrate' in navigator) {
                navigator.vibrate(50); // Short vibration for block mining
            }
        }

        // Show mobile optimization notice
        function showMobileOptimizationNotice() {
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
            
            if (isMobile || isTouchDevice) {
                console.log('Mobile device detected - touch controls enabled');
                // Add mobile-specific class to body for additional styling if needed
                document.body.classList.add('mobile-device');
            }
        }

        // Initialize mobile optimizations
        showMobileOptimizationNotice();

        // Blood level trigger shortcut: Ctrl + Shift + B
        document.addEventListener('keydown', function(e) {
            if ((e.key === 'b' || e.key === 'B') && e.ctrlKey && e.shiftKey) {
                e.preventDefault(); // Prevent any default browser behavior
                // Instant blood level trigger for testing
                blockCount = 666;
                counter.textContent = blockCount;
                triggerBloodLevel();
                console.log('Blood level triggered via shortcut!');
            }
        });

        // Initialize with first background theme
        body.classList.add('bg-plains');

        // Mobile menu functionality
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });

            // Close mobile menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!mobileMenuBtn.contains(e.target) && !mobileMenu.contains(e.target)) {
                    mobileMenu.classList.add('hidden');
                }
            });

            // Close mobile menu when clicking on a link
            const mobileLinks = mobileMenu.querySelectorAll('a');
            mobileLinks.forEach(link => {
                link.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            });
        }

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth'
                    });
                }
            });
        });

        function createBloodJumpscare() {
            // Create jumpscare overlay
            const jumpscare = document.createElement('div');
            jumpscare.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: #000000;
                z-index: 99999;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                opacity: 0;
                transition: opacity 0.1s ease-in;
            `;
            
            // Jumpscare content
            jumpscare.innerHTML = `
                <div style="
                    font-size: 120px;
                    color: #FF0000;
                    font-family: 'Courier New', monospace;
                    font-weight: bold;
                    text-align: center;
                    text-shadow: 0 0 50px #FF0000;
                    animation: bloodFlash 0.1s infinite;
                ">
                    💀🩸
                </div>
                <div style="
                    font-size: 48px;
                    color: #FFFFFF;
                    font-family: 'Courier New', monospace;
                    font-weight: bold;
                    text-align: center;
                    margin-top: 20px;
                    text-shadow: 3px 3px 0 #000;
                    animation: screamText 0.2s infinite;
                ">
                    BLOOD CONSUMED!
                </div>
                <div style="
                    font-size: 24px;
                    color: #FF6666;
                    font-family: 'Courier New', monospace;
                    text-align: center;
                    margin-top: 15px;
                    animation: pulseRed 0.3s infinite;
                ">
                    THE REALM FEEDS ON YOUR SOUL...
                </div>
            `;
            
            // Add jumpscare animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes bloodFlash {
                    0%, 100% { color: #FF0000; text-shadow: 0 0 50px #FF0000; }
                    50% { color: #8B0000; text-shadow: 0 0 100px #8B0000; }
                }
                
                @keyframes screamText {
                    0%, 100% { transform: scale(1) rotate(0deg); }
                    25% { transform: scale(1.1) rotate(-2deg); }
                    75% { transform: scale(0.9) rotate(2deg); }
                }
                
                @keyframes pulseRed {
                    0%, 100% { opacity: 1; transform: scale(1); }
                    50% { opacity: 0.7; transform: scale(1.05); }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(jumpscare);
            
            // Flash effect - instantly visible
            setTimeout(() => {
                jumpscare.style.opacity = '1';
            }, 50);
            
            // Play jumpscare sound effect (if audio is available)
            try {
                // Create audio context for jumpscare sound
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Create a scary low-frequency sound
                oscillator.frequency.setValueAtTime(80, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(40, audioContext.currentTime + 0.3);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                // Audio not available, continue without sound
                console.log('Audio not available for jumpscare');
            }
            
            // Screen shake effect
            document.body.style.animation = 'bloodShake 0.5s ease-in-out';
            const shakeStyle = document.createElement('style');
            shakeStyle.textContent = `
                @keyframes bloodShake {
                    0%, 100% { transform: translate(0, 0); }
                    10% { transform: translate(-5px, -2px); }
                    20% { transform: translate(5px, 2px); }
                    30% { transform: translate(-3px, 1px); }
                    40% { transform: translate(3px, -1px); }
                    50% { transform: translate(-2px, 2px); }
                    60% { transform: translate(2px, -2px); }
                    70% { transform: translate(-1px, 1px); }
                    80% { transform: translate(1px, -1px); }
                    90% { transform: translate(-1px, 0px); }
                }
            `;
            document.head.appendChild(shakeStyle);
            
            // Remove jumpscare after 1 second
            setTimeout(() => {
                jumpscare.style.opacity = '0';
                setTimeout(() => {
                    jumpscare.remove();
                    style.remove();
                    shakeStyle.remove();
                    document.body.style.animation = '';
                }, 200);
            }, 1000);
        }

        function disableBloodLevelButtons() {
            // Disable and corrupt all stop/reset buttons during blood level
            const buttons = [stopBtn, resetBtn, compactStopBtn, compactResetBtn];
            
            buttons.forEach(button => {
                if (button) {
                    // Save original text if not already saved
                    if (!button.dataset.originalText) {
                        button.dataset.originalText = button.textContent;
                    }
                    
                    // Change text to ERROR and disable
                    button.textContent = '❌ ERROR';
                    button.disabled = true;
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                    button.style.backgroundColor = '#8B0000'; // Dark red background
                    button.style.color = '#FF0000'; // Red text
                    button.style.border = '2px solid #FF0000';
                    
                    // Add error hover effect
                    button.onmouseover = function() {
                        this.style.backgroundColor = '#FF0000';
                        this.style.color = '#FFFFFF';
                    };
                    button.onmouseout = function() {
                        this.style.backgroundColor = '#8B0000';
                        this.style.color = '#FF0000';
                    };
                }
            });
        }

        function enableBloodLevelButtons() {
            // Restore buttons when leaving blood level (for reset functionality)
            const buttons = [stopBtn, resetBtn, compactStopBtn, compactResetBtn];
            
            buttons.forEach(button => {
                if (button && button.dataset.originalText) {
                    // Restore original text and functionality
                    button.textContent = button.dataset.originalText;
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.cursor = 'pointer';
                    button.style.backgroundColor = ''; // Reset to original
                    button.style.color = ''; // Reset to original
                    button.style.border = ''; // Reset to original
                    
                    // Remove error hover effects
                    button.onmouseover = null;
                    button.onmouseout = null;
                    
                    // Clear saved original text
                    delete button.dataset.originalText;
                }
            });
        }

        // ...existing code...
        
        // Event listeners and initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize next biome display
            updateNextBiomeDisplay();
            
            // Game control event listeners
            startBtn.addEventListener('click', startGame);
            stopBtn.addEventListener('click', stopGame);
            resetBtn.addEventListener('click', resetGame);
            compactStopBtn.addEventListener('click', stopGame);
            compactResetBtn.addEventListener('click', resetGame);
            musicToggleBtn.addEventListener('click', toggleMusic);
            compactMusicToggleBtn.addEventListener('click', toggleMusic);
            
            // Mobile menu toggle
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenu = document.getElementById('mobileMenu');
            
            if (mobileMenuBtn && mobileMenu) {
                mobileMenuBtn.addEventListener('click', function() {
                    mobileMenu.classList.toggle('hidden');
                });
            }
        });
    </script>
</body>
</html>
